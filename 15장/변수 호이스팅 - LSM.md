## 15.1.3 변수 호이스팅

## 15.2.3 변수 호이스팅

<br/>

`var` 키워드로 변수를 선언하면 변수 호이스팅에 의해 변수 선언문이 스코프의 선두로 끌어 올려진 것처럼 동작합니다.

즉, 변수 호이스팅에 의해 `var` 키워드로 선언한 변수는 변수 선언문 이전에 참조할 수 있지만, 할당문 이전에 변수를 참조하면 언제나 undefined를 반환합니다.

```javascript
// 이 시점에는 변수 호이스팅에 의해 이미 example 변수가 선언됨 (1. 선언 단계)

// 변수 example은 undefined로 초기화됨 (2. 초기화 단계)
console.log(example); // undefined

// 변수에 값을 할당 (3. 할당 단계)
example = "abc";
console.log(example); // abc

// 변수 선언문은 런타임 이전에 자바스크립트 엔진에 의해 암묵적으로 실행됨
var example;
```

`var` 키워드로 선언한 변수는 런타임 이전에 자바스크립트 엔진에 의해 암묵적으로 `선언 단계`와 `초기화 단계`가 한번에 진행됩니다.

즉, 선언 단계에서 `스코프(실행 컨텍스트의 렉시컬 환경)`에 변수 식별자를 등록해 자바스크립트 엔진에 변수의 존재를 알리고, 즉시 초기화 단계에서 undefined로 변수를 초기화합니다.

따라서 변수 선언문 이전에 변수에 접근해도 스코프에 변수가 존재하기 때문에 에러가 발생하지 않지만 undefined를 반환합니다.

이후 변수 할당문에 도달하면 비로소 값이 할당됩니다.

<br/><br/>

`var` 키워드로 선언한 변수와 달리 `let` 키워드로 선언한 변수는 변수 호이스팅이 발생하지 않는 것처럼 동작합니다.

```javascript
// 런타임 이전에 선언 단계가 실행됨, 아직 변수는 초기화 되지 않음

// 초기화 이전의 일시적 사각지대에서는 변수를 참조할 수 없음
console.log(example); // ReferenceError: example is not defined

let example; // 변수 선언문에서 초기화 단계가 실행됨
console.log(example); // undefined

example = "abc"; // 할당문에서 할당 단계가 실행됨
console.log(example); // abc
```

이처럼 `let` 키워드로 선언한 변수를 변수 선언문 이전에 참조하면 참조 에러가 발생합니다.

<br/>

`let` 키워드로 선언한 변수는 `선언 단계`와 `초기화 단계`가 분리되어 진행됩니다.

즉, 런타임 이전에 자바스크립트 엔진에 의해 암묵적으로 선언 단계가 먼저 실행되지만, 초기화 단계는 변수 선언문에 도달했을 때 실행됩니다.

만약 초기화 단계가 실행되기 이전에 변수에 접근하려고 하면 참조 에러가 발생합니다.

<br/>

스코프의 시작 지점부터 초기화 시작 지점(변수 선언문)까지 변수를 참조할 수 없는 구간을 `일시적 사각지대(Temporal Dead Zone: TDZ)`라고 부르는데, `let` 키워드로 선언한 변수는 `TDZ`에서 변수를 참조할 수 없습니다.

변수 선언문 이전에 변수를 참조하는 것은 변수 호이스팅에 의해 에러를 발생시키지는 않지만, 프로그램의 흐름상 맞지 않을뿐더러 가독성을 떨어뜨리고 예기치 못한 오류를 발생시킬 수 있으므로 지양해야 합니다.

<br/>

결국 `let` 키워드로 선언한 변수는 변수 호이스팅이 발생하지 않는 것처럼 보이지만 그렇지 않습니다.

```javascript
let example = 1; // 전역 변수
{
  console.log(example); // ReferenceError: Cannot access 'example' before initialization
  let example = 2; // 지역 변수
}
```

`let` 키워드로 선언한 변수의 경우 변수 호이스팅이 발생하지 않는다면, 위 예제는 `전역 변수 example`의 값을 출력해야하지만, `let` 키워드로 선언한 변수도 여전히 호이스팅이 발생하기 때문에 참조 에러가 발생합니다.

<br/>

자바스크립트는 ES6에 도입된 `let, const`를 포함해서 모든 선언(`var, let, const, function, function*, class 등`)을 호이스팅 합니다.

단 ES6에서 도입된 `let, const, class`를 사용한 선언문은 호이스팅이 발생하지 않는 것처럼 동작할 뿐입니다.
